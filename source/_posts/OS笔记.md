# OS笔记
title: OS笔记

tags: 笔记

<!--more -->

---
## 操作系统
1. 进程调度，进程通信，内存管理，设备管理，文件管理，网络通信，作业控制。  
2. 系统调用--操作系统实现特定功能的过程，为程序提供访问操作系统的接口。（访管指令，异常中断指令）

***
## 中断
1. 中断--暂时中止CPU上运行的程序，转去执行相应的事件处理程序（操作系统是中断驱动的）。
    I/O ，外围设备，系统调用。
2. 异常，当前运行的指令引起的中断事件。
    处理器：算术异常、非法存取、终止进程。
    内存储器，总线等硬件故障。
3. 中断屏蔽--决定是否相应中断。
4. 中断优先级，中断嵌套处理。

***
## 进程
1. **进程**--操作系统为管计算机系统中运行的程序所建立的一个管理实体，是具有独立功能的程序关于数据的运行活动，是操作系统进行资源调度和分配的一个独立单位。
2. **进程**包括五个部分：os部分--**管理运行程序的数据结构**P，控制程序执行的**程序状态字信息**PSW。程序部分--**内存代码**C，内存数据D，通用寄存器信息R。
3. **进程状态**：运行态，就绪态，等待态。
    挂起：资源不足（性能低，死锁）->资源被剥夺。
4. **进程控制块**（Process Control Block）--用于记录和刻画进程状态及环境信息的数据结构。
    **标识信息**：进程标识（系统：系统标识号，进程组标识号；用户：进程名，进程组名）
    **现场信息**：进程运行时处理器现场信息：用户可见寄存器（数据，地址），控制与状态寄存器（PC、IR、PSW），栈指针。
    **控制信息**：存放与管理、调度进程相关的信息。
5. **模式切换**（处理器状态切换）
    * 进程切换必须在内核模式下完成
    * 用户模式->内核模式（中断，系统调用，异常）；内核模式->用户模式（os执行中断返回指令）
6. 进程控制与管理
    * 进程创建：进程表加一项，申请PCB并初始化，生成标识，建立映像，分配资源，移入就绪队列。
    * 进程撤销：和创建相反
    * 进程阻塞：保存现场信息，修改PCB，移入等待队列
    * 进程唤醒
    * 进程挂起：修改状态，移入相关队列，收回内存等资源，送至对换区
    * 进程激活
7. 进程管理软件
    * 系统调用/中断/异常处理程序
    * 队列管理模块
    * 进程控制/调度/通信程序
    * 外围程序（终端登陆，作业控制，性能监控）
8. 进程上下文--用户级（用户程序块，用户数据区，用户栈，用户共享内存）；寄存器（PSW，栈指针，通用寄存器）；系统级（PCB，内存区表，核心栈）
***
9. 线程
    * 进程切换开销大；通信开销大；并发粒度低；并行计算效率低
    * "独立分配资源"与"调度分派执行"，进程是系统资源分配的独立单位，不需要频繁地切换。
    * 线程是系统调度和分派的基本单位，能轻装运行，会被频繁地调度和切换，并发粒度更细，并发性更好。

***
## 处理器
1. 调度的层次
    * 高级调度（长程调度，作业调度）：决定能否加入到执行的进程池中。
    * 中级调度（平衡负载调度）：决定主存中的可用进程集合。
    * 低级调度（短程调度，进程调度，处理器调度）：决定哪个可用进程占用处理器执行。
2. 调度算法
    * 时间片轮转调度算法
    * 分级调度算法（不同优先级）
    * 彩票调度算法（类似令牌）
3. [抢占时任务调度与非抢占式的区别](https://blog.csdn.net/u013176681/article/details/39256191)（什么时候我也能这么能吹）

***
## 存储管理（star）

***
## 文件系统

***
## 并发程序设计
1. 特性：
    * 并发性：多个进程并行执行，提高了计算效率。
    * 共享性：多个进程共享软件资源。
    * 交往性：制约，有难度。
2. 互斥与同步
    * 互斥：相互争夺独占性资源
    * 同步：为完成共同任务 协调执行先后关系
3. 信号量
    * 记录型信号量
    ```c++  
    typedef struct semaphore
    {
        int vales;  //信号量值
        struct pcb *list; //信号量等待进程队列指针
    }
    
    ```
    * P、V操作原语
    ```c++
    procedure P(semaphore:s)
    {
        s -= 1;     //信号量-1
        if (s<0) W(s);//若信号量小于0，则调用进程被置成等待信号量s的状态
    }
    
    procedure V(semaphore:s)
    {
        s += 1;     //信号量+1
        if (s<=0) R(s); //// 若信号量小于等于0，则释放一个等待信号量s的进程
    }
    ```
4. 管程
    把分散在各个进程中互斥地访问公共变量地临界区集中起来管理，它局部变量只能由该管程的过程存取。
    管程的条件变量：
    * 条件变量(condition variables):当调用管程过程的进程无法运行时，用于阻塞进程的信号量。
    * 同步原语wait：没有资源->阻塞进程
    * 同步原语signal:释放条件变量上阻塞的进程
5. 进程通信
    


